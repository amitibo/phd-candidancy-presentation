%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%% preamble %%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[compress,red,12pt]{beamer}
\mode<presentation>

%
% Beamer default paper size is 128mm by 96mm
%

\input{custom_beamer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%% Pacakges  %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% include packages
%
\usepackage[latin1]{inputenc}
\usepackage[small]{caption}
\captionsetup{labelformat=empty, labelsep=none}
\usepackage{animate}
\usepackage{graphicx}
\graphicspath{{./images/}}
\usepackage{bm}
\usepackage{fancybox}
\usepackage{media9}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[overlay,absolute]{textpos}
\usepackage{cancel}

\input{custom_tikz}
\input{custom_commands}

%
% To speed up of compilation
%
%\includeonlyframes{current}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%% title page information %%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title[3D Aerosol Recovery]{
  Lightfield Analysis and Recovery of the Atmosphere
}

\author[Amit Aides]{
  Amit Aides \\
  Supervisor: Prof. Yoav Y. Schechner
}

\date{12 September 2013}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%% begin %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Motivation}

\begin{frame}[label=motivation]{Aerosols in the Atmosphere}
  \begin{center}
    \includegraphics[height=7cm]{images/shenzen_haze.jpg}
  \end{center}    
  \begin{center}
    \hyperlink{aerosols-data}{\beamergotobutton{Aerosols Info}}\hfill
    {\tiny http://earthobservatory.nasa.gov/Features/Aerosols/}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[label=current]{Eyjafjallaj\"{o}kull Eruption in 2010}
  \begin{center}
    \includegraphics[height=7cm]{images/volcano-airport.jpg}
  \end{center}
  \begin{flushright}
    \includemedia[
    addresource=sounds/mountain_name.mp3,
    flashvars={
      source=sounds/mountain_name.mp3
      &autoPlay=false
    }
    ]{\fbox{Play}}{APlayer.swf}
    {\tiny http://www.metrolic.com/eyjafjallajokull-is-dormant...for-the-moment-2042/}
  \end{flushright}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{PhD Task}

\begin{frame}{Multi-angle Tomographic Reconstruction}
  \begin{center}
    \only<1>
    {
      \centerline{\def\svgwidth{\linewidth}\small{\input{images/camera_network1.pdf_tex}}}
    }
    \only<2>
    {
      \centerline{\def\svgwidth{\linewidth}\small{\input{images/camera_network2.pdf_tex}}}
    }
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Multi-angle imaging from the ground}
  \begin{columns}[T]
    \begin{column}{.5\textwidth}
      \begin{itemize}
      \item 3D reconstruction
      \item Simple setup
      \item Based on Sun light scattering and attenuation
      \end{itemize}
    \end{column}
    \begin{column}{.5\textwidth}
      \centering
      {\includegraphics[height=3cm]{images/camera_network-1.png}}
    \end{column}
  \end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Simulated Reconstruction}
  \begin{center}
    \only<1>{
      \animategraphics[width=0.7\linewidth, loop, controls, buttonsize=5pt]{3}{images/result_movie1/snapshot1_}{0}{35}
    }
    \only<2>{
      \animategraphics[width=0.7\linewidth, loop, controls, buttonsize=5pt]{3}{images/result_movie1/snapshot2_}{0}{35}
    }
  \end{center}
  \begin{center}
    \tiny{Color represents aerosol density. The density units are $10^{6}~{\rm particles}/{\rm m}^3$}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{}
  \includemedia[
  label=video1,
  width=1.0\linewidth,height=0.66\linewidth,
  activate=pageopen,
  addresource=videos/cloudsnew.mp4,
  flashvars={source=videos/cloudsnew.mp4}
  ]{}{VPlayer.swf}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{}
  \begin{center}
    \begin{block}{Publications}
      \begin{itemize}
      \item Presented in the MISR Data Users Science Symposium Dec. 2012, Pasadena, CA, USA
      \item In review, Optics Express.
      \end{itemize}
    \end{block}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{State of The Art}

\TitleFrame{}{State of The Art}

\begin{frame}{Remote Sensing}
  \begin{center}
    \includegraphics[width=0.9\textwidth]{images/misr.pdf}
  \end{center}
  \begin{flushright}
    {\tiny http://earthobservatory.nasa.gov/}
  \end{flushright}
  \only<2>
  {
    \CloudNote{0.4\textwidth}{0, 0}{
      Low resolution \\
      2D reconstruction \\
      Top viewing point \\
      Expensive}
  }
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{LIDAR - Light Detection And Ranging}
  \begin{center}
    \includegraphics[width=0.9\columnwidth]{images/lidar.pdf}
  \end{center}

  \begin{flushright}
    {\tiny http://jp.hamamatsu.com/en/rd/technology/energy/lidar.html}
    %\only<2> {\tiny http://earthobservatory.nasa.gov/}
  \end{flushright}
  \only<2>
  {
    \CloudNote{0.4\textwidth}{0, 0}{
      Local \\
      Expensive}
  }
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Radiative Transfer}

\begin{frame}{Radiation Transfer}
  Light interaction with the atmosphere:
  \begin{itemize}
  \item Loses energy to absorption
  \item Gains energy by emission
  \item Redistributes energy by scattering
  \end{itemize}
  % \begin{align*}
  %   \hat{\Omega} \cdot \nabla I &+ (k_{s}+k_{a}) I_\nu = \\
  %   &j + \frac{1}{4\pi} \int_\Omega I \cdot P(\hat{\Omega},\Omega) d\Omega
  % \end{align*}    
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% TODO improve this:
% - Explain symbols
% - Explain better the optical depth
% 
\begin{frame}{Attenuation}
  \begin{block}{Light is attenuated according to {\em Beer-Lambert} law}
    \centerline{\def\svgwidth{0.6\columnwidth}\small{\input{images/beer_lambert.pdf_tex}}}
  \end{block}
  \onslide<2>
  {
    \begin{block}{Optical Depth}    
      \begin{align*}
        \tau = \int \sigma n \derivsym{x}
      \end{align*}
      Measures transparency of medium
    \end{block}
  }
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% TODO - Improve this
% Add explaination on the \alpha sign that appears later in the presentation
%
\begin{frame}{Scattering}
    \begin{overprint}
      \only<1>
      {
        \centerline{\def\svgwidth{0.6\linewidth}\small{\input{images/phase_function1.pdf_tex}}}
      }
      \only<2>
      {
        \centerline{\def\svgwidth{0.6\linewidth}\small{\input{images/phase_function2.pdf_tex}}}
      }
      \only<3->
      {
        \centerline{\def\svgwidth{0.6\linewidth}\small{\input{images/phase_function3.pdf_tex}}}
      }
    \end{overprint}
    \onslide<4>
    {
      \begin{center}{Scattering Ratio}
        \begin{align*}
          \alpha = k \sigma P(\theta) \derivsym{\theta}
        \end{align*}
      \end{center}
    }
\end{frame}

%%%

\begin{frame}[T]{Phase Functions Used}
  \begin{columns}[T]
    \column{0.6\textwidth}
    \begin{itemize}
    \item Rayleigh scattering - for air molecules
    \item Henyey-Greenstein equation - for aerosols
    \end{itemize}
    \column{0.4\textwidth}
    \centering
    \includegraphics[height=4cm]{images/Mie_Rayleigh.jpg}
  \end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ongoing PhD Research}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{overview}

\begin{frame}{}
  \begin{center}
    \includegraphics<1>[height=8cm]{images/diagram.pdf}    
    \includegraphics<2>[height=8cm]{images/diagram_reference_images.pdf}    
    \includegraphics<3>[height=8cm]{images/diagram_models.pdf}    
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Image formation using the single-scattering model}

\begin{frame}{Single-Scattering Model}
  \begin{columns}[C]
    \column{0.4\textwidth}
    \begin{itemize}
    \item Simple
    \item Fast
    \item Analytic
    \end{itemize}

    \column{0.6\textwidth}
    \includegraphics[width=\columnwidth]{images/diagram_models_single.pdf}

  \end{columns}
\end{frame}

%%%

\begin{frame}{Single-Scattering Model}
  \begin{columns}[c]
    \column{0.5\columnwidth}
    \setbeamercovered{transparent}
    \begin{itemize}
    \item <1-2> Atmosphere volume
    \item <2-3> Voxel - Volume Element
    \item <3> Contains air and aerosols
    \item <4> Light is attenuated due to scattering and absorption
    \item <5> Light scatters only once between source and viewer
    \item <6> Light is attenuated due to scattering and absorption
    \item <7> Simple Analytic model
    \item <7> No Multi-Scattering
    \end{itemize}

    \column{0.5\columnwidth}
    \begin{overlayarea}{\columnwidth}{8cm}
      \only<1> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D1.pdf}}}
      \only<2> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D2.pdf}}}
      \only<3> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D3.pdf}}}
      \only<4> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D4.pdf}}}
      \only<5> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D5.pdf}}}
      \only<6> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D6.pdf}}}
      \only<7> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D7.pdf}}}
    \end{overlayarea}
  \end{columns}
\end{frame}

%%%

\begin{frame}{Image Formation Model}
  \begin{columns}[c]

    \column{0.7\textwidth}
    \begin{itemize}
    \item <3-> Attenuation \tikz[na] \node[coordinate] (s2) {};
    \item <4-> Scattering \tikz[na] \node[coordinate] (s3) {};
    \end{itemize}

    % \small
    \footnotesize
    \begin{align*}
      \mathrm{I} &= \\
      & \tikz[baseline]{ \node[nodeblue] (d1) {$\mathrm{L}^{\rm TOA}$}; } \,
      \tikz[baseline]{ \node[nodered] (d4) {$\OpCamera$}; }
      \curly{\roundy{
          \tikz[baseline]{ \node[nodegreen] (d3) {$\vect{\alpha}^{\rm aerosol} + \vect{\alpha}^{\rm air}$}; } }  \odot 
        \tikz[baseline]{ \node[nodeyellow] (d2) {$\exp^{-(\vect{\tau}^{\rm aerosol} + \vect{\tau}^{\rm air})}$}; } }
    \end{align*}
    \normalsize

    \begin{itemize}
    \item <2-> Sun \tikz[na] \node[coordinate] (s1) {}; luminance 
    \item <5-> Camera projection \tikz[na] \node[coordinate] (s4) {};
    \end{itemize}

    \begin{tikzpicture}[overlay]
      \onslide<2->{\path[->] (s1) edge [bend right] (d1);}
      \onslide<3->{\path[->] (s2) edge [bend left] (d2);}
      \onslide<4->{\path[->] (s3) edge [bend left] (d3);}
      \onslide<5->{\path[->] (s4) edge [bend right] (d4);}
    \end{tikzpicture}

    \column{0.3\textwidth}
    \begin{overprint}
      \only<1-2> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D2.pdf}}}
      \only<3> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D3.pdf}}}
      \only<4-> {\centerline{\includegraphics[width=\columnwidth]
          {images/atmo_settings3D5.pdf}}}
    \end{overprint}

  \end{columns}
\end{frame}

%%%

\begin{frame}[label=settings]{Simulation Settings}
  \begin{center}
    \begin{overlayarea}{\columnwidth}{8cm}
        \only<1>
        {\centerline{\includegraphics[width=\columnwidth]{images/voxels1.pdf}}}
        \only<2>
        {\centerline{\includegraphics[width=\columnwidth]{images/voxels2.pdf}}}
        \only<3>
        {\centerline{\includegraphics[width=\columnwidth]{images/voxels3.pdf}}}
        \only<4>
        {
          \hfill\hyperlink{air-density}{\beamergotobutton{Air Density}}  
          \centerline{\includegraphics[width=\columnwidth]{images/voxels4.pdf}}
        }
        \only<5>
        {
          \hfill\hyperlink{typical-concentrations}{\beamergotobutton{Aerosol Distribution}}  
          \centerline{\includegraphics[width=\columnwidth]{images/voxels5.pdf}}
          \begin{center}
            \tiny{Color represents aerosol density. The density units are $10^{6}~{\rm particles}/{\rm m}^3$}
          \end{center}
        }
    \end{overlayarea}
  \end{center}
\end{frame}

%%%

\begin{frame}{Synthesized Examples}
  \begin{columns}[C]
    \begin{column}{.7\textwidth}
      \begin{overlayarea}{\columnwidth}{8cm}
        \only<1>
        {\centerline{\includegraphics[height=7cm]{images/single_img1.pdf}}}
        \only<2>
        {\centerline{\includegraphics[height=7cm]{images/single_img2.pdf}}}
        \only<3>
        {\centerline{\includegraphics[height=7cm]{images/single_img3.pdf}}}
        \only<4>
        {\centerline{\includegraphics[height=7cm]{images/single_img4.pdf}}}
        \only<5>
        {\centerline{\includegraphics[height=7cm]{images/single_img5.pdf}}}
        \only<6>
        {\centerline{\includegraphics[height=7cm]{images/single_img6.pdf}}}
        \only<7>
        {\centerline{\includegraphics[height=7cm]{images/single_img7.pdf}}}
        \only<8>
        {\centerline{\includegraphics[height=7cm]{images/single_img8.pdf}}}
        \only<9>
        {\centerline{\includegraphics[height=7cm]{images/single_img9.pdf}}}
      \end{overlayarea}
    \end{column}
    \begin{column}{.3\textwidth}
      \begin{figure}
        \centering
        \includegraphics[width=\columnwidth]{images/atmo3d.pdf}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Multi-Scattering Simulations}

\begin{frame}{Forward Simulated Models}
  \begin{columns}[C]
    \column{0.6\textwidth}
    \includegraphics[width=\columnwidth]{images/diagram_models_multi.pdf}

    \column{0.4\textwidth}
    \begin{itemize}
    \item Physical
    \item Slow
    \item Not Analytic
    \item Joint work with Mr. Vadim Holodovsky
    \end{itemize}
  \end{columns}
\end{frame}

%%%

\begin{frame}{Monte Carlo Method}
  \begin{figure}
    \centering
    \begin{overprint}
      \only<1>
      {\centerline{\includegraphics[height=7cm]{images/roullete.jpg}}} % Image taken from wikimedia commons 
      \only<2>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method1.pdf_tex}}}}
      \only<3>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method2.pdf_tex}}}}
      \only<4>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method3.pdf_tex}}}}
      \only<5>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method4.pdf_tex}}}}
      \only<6>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method5.pdf_tex}}}}
      \only<7>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method6.pdf_tex}}}}
      \only<8>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method7.pdf_tex}}}}
      \only<9>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method8.pdf_tex}}}}
      \only<10>
      {\centerline{\def\svgwidth{0.9\linewidth}\small{\input{images/mc_method9.pdf_tex}}}}
    \end{overprint}
  \end{figure}
\end{frame}

%%%

\begin{frame}{Monte Carlo Results}
  \begin{columns}[T]
    \begin{column}{.5\textwidth}
      \centering
      \only<1>
      {
        \includegraphics[height=0.60\textheight]{images/result_mc.pdf}
        \captionof{figure}{Monte Carlo Model}
      }
      \only<2>
      {
        \centerline{\def\svgwidth{0.8\linewidth}\footnotesize{\input{images/cross_section_x.pdf_tex}}}
        \captionof{figure}{X Cross Section}
      }
    \end{column}
    \begin{column}{.5\textwidth}
      \centering
      \only<1>
      {
        \includegraphics[height=0.60\textheight]{images/result_single.pdf}
        \captionof{figure}{Single Scattering Model}
      }
      \only<2>
      {
        \centerline{\def\svgwidth{0.8\linewidth}\footnotesize{\input{images/cross_section_y.pdf_tex}}}
        \captionof{figure}{Y Cross Section}
      }
    \end{column}
  \end{columns}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Inverse Problem}

\begin{frame}{Inverse Problem}
  \begin{center}
    \includegraphics[height=5cm]{images/diagram_algorithm.pdf}
  \end{center}
\end{frame}

\begin{frame}{Multi-angle Tomographic Reconstruction}
  \begin{center}
    \centerline{\def\svgwidth{\linewidth}\small{\input{images/camera_network2.pdf_tex}}}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Tomography}
% TODO Maybe add a simple equation that explains the formation of the projection

\begin{frame}{Tomography}
  \begin{block}{}
    Reconstruct 3D object from its set of projections    
  \end{block}
\end{frame}

\begin{frame}{Attenuation Tomography}
  \begin{columns}
    \column{.5\textwidth}
    \includegraphics[height=6cm]{images/ct.png}
    \column{.5\textwidth}
    \includegraphics[height=5cm]{images/ct.jpg}
  \end{columns}  
  \begin{flushright}
    \only{\tiny http://medical-dictionary.thefreedictionary.com}
  \end{flushright}
  \only<2>
  {
    \CloudNote{0.4\textwidth}{0, 0}{
      Attenuation based \\
      Linear problem
    }
  }
\end{frame}

%%%

\begin{frame}{Emission Tomography}
  \begin{columns}
    \column{.5\textwidth}
    \begin{center}
      \includegraphics[width=\columnwidth]{images/tomography_emission.jpg}
      \captionof{figure}{\tiny Gregson at el. 2010}
    \end{center}
    \column{.5\textwidth}    
    \begin{center}
      \includegraphics[height=0.40\textheight]{gas.jpg}
      \captionof{figure}{\tiny Cosofret at el. 2009}
    \end{center}
  \end{columns}
  \only<2>
  {
    \CloudNote{0.4\textwidth}{0, 0}{
      No scattering \\
      Linear problem
    }
  }
\end{frame}

%%%

\begin{frame}{Optical Tomography}
  \begin{columns}[C]
    \begin{column}{.7\textwidth}
      \begin{itemize}
      \item Optical Tomography assumes a highly scattering medium
      \end{itemize}
    \end{column}
    \begin{column}{.3\textwidth}
      \centering
      \includegraphics[height=0.30\textheight]{Optical_Tomography.png}
    \end{column}
  \end{columns}  
  \only<2>
  {
    \CloudNote{0.4\textwidth}{0, 0}{
      Diffuse approximation \\
      Controlled source
    }
  }
\end{frame}

%%%
 
\begin{frame}{Integral Imaging, Light-Field, Plenoptic}
  \begin{columns}[C]
    \begin{column}{.7\textwidth}
      \begin{itemize}
      \item Sample light in space and direction
      \item Enables re-focus, depth recovery, etc
      \end{itemize}
    \end{column}
    \begin{column}{.3\textwidth}
      \centering
      \includegraphics[height=0.30\textheight]{stanford_camera_array_640x480.jpg}
      \captionof{figure}{\tiny http://graphics.stanford.edu/}
      \includegraphics[height=0.30\textheight]{light-field-camera.jpg}
      \captionof{figure}{\tiny http://lightfield-forum.com}
    \end{column}
  \end{columns}
  \only<2>
  {
    \CloudNote{0.3\textwidth}{0, 0}{
      Small scale
    }
  }
\end{frame}

%%%

\begin{frame}{Multi-angle Tomographic Reconstruction}
  \begin{center}
    \centerline{\def\svgwidth{\linewidth}\small{\input{images/camera_network2.pdf_tex}}}
  \end{center}
\end{frame}

%%%

\begin{frame}{Challenge}
  \begin{center}
    \centering
    \only<1>{\includegraphics[height=7cm]{images/challenge1.pdf}}
    \only<2>{\includegraphics[height=7cm]{images/challenge2.pdf}}
    \only<3>
    {
      \begin{itemize}
      \item Solutions:
        \begin{enumerate}
        \item Prior Knowledge
        \item Large scale solvers
        \item Parallelize the algorithm
        \end{enumerate}
      \end{itemize}
    }
  \end{center}
\end{frame}

%%%

\begin{frame}{Prior Knowledge}
  
  \begin{columns}
    \column{0.4\paperwidth}
    \begin{itemize}
    \item <2-> Known air distribution \tikz[na] \coordinate (known-air);
    \item <3-> \alert{Single known aerosol particle} \tikz[na] \coordinate (known-part);
    \item <5-> Smoothness 
    \end{itemize}
    
    \column{0.45\paperwidth}
    \tikzstyle{background grid}=[draw, black!50,step=.5cm]
    \begin{tikzpicture}%[show background grid]
      % Put the graphic inside a node. This makes it easy to place the
      % graphic and to draw on top of it. 
      % The above right option is used to place the lower left corner
      % of the image at the (0,0) coordinate. 
      \onslide<4->{      
        \node [inner sep=0pt,above right] 
        {\centerline{\def\svgwidth{4cm}\input{images/challenge_only_n.pdf_tex}}};
      }

      % define destination coordinates
      \path (0.75, 2.25) coordinate (only-n-up)
            (0.75, 1.00) coordinate (only-n-down);
    \end{tikzpicture}

    % define overlays
    % Note the use of the overlay option. This is required when 
    % you want to access nodes in different pictures.
    \begin{tikzpicture}[overlay]
      \onslide<4->{
        \path[->,blue,thick] (known-air) edge [bend left] (only-n-up);
        \path[->,red,thick] (known-part) edge [bend right] (only-n-down);
      }
    \end{tikzpicture}
  \end{columns}
\end{frame}

%%%

\begin{frame}{Optimization}
  \begin{itemize}
  \item L-BFGS-B
    \begin{thebibliography}{blablabla}
    \bibitem[blablabla]{blablabla}
      R. H. Byrd, P. Lu and J. Nocedal.
      \newblock A Limited Memory Algorithm for Bound Constrained Optimization.
      \newblock {\em SIAM Journal on Scientific and Statistical Computing}, 1995.
    \end{thebibliography}
  \item Requires only the objective and its gradient
  \end{itemize}
\end{frame}

%%%

\begin{frame}[label=objective]{Optimization}
  \begin{block}{Objective Function}
    \begin{equation*}
      \only<1-5>{
        \CostFunc{\DistUnknown}
        = \sum_{c=1}^{N_{\rm views}}
        \left\|
          \tikz[baseline]{[\node[na] (d-im) {${\bm i}^{\rm measured}_c$};} - 
          \tikz[baseline]{[\node[na] (d-ie) {${\bm i}_c$};}
          \tikz[baseline]{[\node[na] (d-un1) {$({\bm n})$};}
        \right\|^2_2  + \eta \tikz[baseline]{ \node[na] (d2) {$\Psi$};}
        \tikz[baseline]{[\node[na] (d-un2) {$({\bm n})$};}
      }
      \only<6->
      {
        \CostFunc{\DistUnknown}
        = \sum_{c=1}^{N_{\rm views}}
        \left\|
          \tikz[baseline]{ \node[na] (d1) {$\MaskSun$};}[{\bm i}^{\rm measured}_c - {\bm i}_c({\bm n})]
        \right\|^2_2  + \eta \Psi ({\bm n})
      }
    \end{equation*}
  \end{block}
  \onslide<7>
  {
    \begin{block}{Estimated Aerosols}
      \begin{equation*}
        \DistEstimated =
        \argmin_{\DistUnknown \in \DistSet} \CostFunc{\DistUnknown}
      \end{equation*}
    \end{block}
  }
  \begin{tikzpicture}[overlay]
    \onslide<2>
    {
      \node[nodeyellow] at (4,1.5)(s1) {\hyperlink{ref_images}{Reference Image}};
      \path[->] (s1) edge [bend right] (d-im);
    }
    \onslide<3>
    {
      \node[nodeyellow] at (8,1.5)(s2) {Estimated Image};
      \path[->] (s2) edge [bend left] (d-ie);
    }
    \onslide<4>
    {
      \node[nodered] at (6,1.5)(s3) {Unkown Aerosols Density};
      \path[->] (s3) edge [bend left] (d-un1);
      \path[->] (s3) edge [bend right] (d-un2);
    }
    \onslide<5>
    {
      \node[nodeblue] at (8,5.5)(s4) {\hyperlink{regularization}{Smoothness Constrain}};
      \path[->] (s4) edge [bend left] (d2);
    }
    \onslide<6>
    {
      \node[nodeblue] at (5,5.7) (s5) {\hyperlink{mask}{Multi-Scatter Mask}};
      \path[->] (s5) edge [bend right] (d1);
    }
  \end{tikzpicture}
\end{frame}

%%%

\begin{frame}{Optimization}
  \begin{block}{Gradient}
    \begin{align*}
      \Grad{{\bm n}} E &= \\
      -&2\sum_{c=1}^{N_{\rm views}}
      \transpose{\left[{\bm J}_{{\bm i}_c}({\bm n})\right]} \transpose{\MaskSun}\MaskSun[{\bm i}^{\rm
        measured}_c - {\bm i}_c({\bm n})] + 2 \eta
      \transpose{\Laplacian}\transpose{{\bf W}}{\bf W}\Laplacian{\bm n}
    \end{align*}
  \end{block}
  \hfill\hyperlink{jacobian}{\beamergotobutton{Jacobian}}
\end{frame}

%%%

\begin{frame}{Parallelization} 
  \begin{columns}
    \column{0.8\textwidth}
    \begin{itemize}
    \item Processed using a computer cluster
    \item Each `camera' processed on a separate core
    \item Up to 100 cores = 100 simulated cameras
    \item A couple of hours to reconstruct 250K voxels
    \end{itemize}

    \column{0.2\textwidth}
    \begin{center}
      \includegraphics[width=\columnwidth]{tamnun.jpg}
    \end{center}
  \end{columns}
\end{frame}

%%%

\begin{frame}{Results - Original Atmospheres}
  \begin{center}
    \centerline{\def\svgwidth{1.15\linewidth}\footnotesize{\input{images/atmo3d_original.pdf_tex}}}
  \end{center}
  \begin{center}
    \tiny{Color represents aerosol density. The density units are $10^{6}~{\rm particles}/{\rm m}^3$}
  \end{center}
\end{frame}

%%%

\begin{frame}{Results - Single-scattering Simulations}
  \begin{center}
    \centerline{\def\svgwidth{1.15\linewidth}\footnotesize{\input{images/atmo3d_single.pdf_tex}}}
  \end{center}
  \begin{center}
    \tiny{Color represents aerosol density. The density units are $10^{6}~{\rm particles}/{\rm m}^3$}
  \end{center}
\end{frame}

%%%

\begin{frame}{Results - Monte-Carlo Simulations}
  \begin{center}
    \centerline{\def\svgwidth{1.15\linewidth}\footnotesize{\input{images/atmo3d_mc.pdf_tex}}}
  \end{center}
  \begin{center}
    \tiny{Color represents aerosol density. The density units are $10^{6}~{\rm particles}/{\rm m}^3$}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Further Research Directions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Empirical Validation}

\begin{frame}{Experiment}
  \only<1>
  {
    \centering
    \includegraphics[height=7cm]{images/diagram_experiment2.pdf}    
  }
  \only<2>
  {
    \begin{columns}[C]
      \begin{column}{.7\textwidth}
        \begin{itemize}
        \item Grab multiple images from moving car
        \item Register images using GPS and/or SfM tools
        \item Collect ground truth
          \begin{itemize}
          \item MISR
          \item LIDAR
          \item AERONET
          \end{itemize}
        \end{itemize}
      \end{column}
      \begin{column}{.3\textwidth}
        \centering
        \includegraphics[height=0.30\textheight]{DSC_0688.JPG}\\
        \includegraphics[height=0.30\textheight]{AERONET.jpg}
        \captionof{figure}{\tiny http://earthobservatory.nasa.gov/}
      \end{column}
    \end{columns}
  }
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Inverse Problem}

\begin{frame}{Model Extension}
  \begin{itemize}
  \item Ground BRDF
  \item Infinite Atmosphere
  \item Multiple particles
    \begin{itemize}
    \item Martonchik at el. 1998
    \end{itemize}
  \item Improve algorithm speed
  \item Account for Multiple-Scattering
  \item Cloudy Skies
  \end{itemize}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Aerosols in Partly Cloudy Skies}

\begin{frame}{Clouds}
  \begin{columns}[T]
    \begin{column}{.6\textwidth}
      \begin{itemize}
      \item High Optical Depth
        \begin{itemize}
        \item Single-Scattering approximation not-valid.
        \end{itemize}
      \item Affect radiation transfer:
        \begin{itemize}
        \item Cast shadows
        \item Reflect light
        \end{itemize}
      \end{itemize}
    \end{column}
    \begin{column}{.4\textwidth}
      \includegraphics[height=0.40\textheight]{clouds.jpg}
    \end{column}
  \end{columns}
\end{frame}

%%%

%
% TODO
% Add refernces to the corresponding images 
%
\begin{frame}{Reconstruction}

  \begin{itemize}
  \item Separate reconstruction
    \begin{itemize}
    \item SfM - Structure from Motion 
    \item Visual Hull
    \end{itemize}

  \item Model extension
    \begin{itemize}
    \item Calculate effective phase function
    \item Add as a separate source
    \end{itemize}
  \end{itemize}

\end{frame}

%%%

\begin{frame}{}
  \includemedia[
  width=1.0\linewidth,height=0.66\linewidth,
  activate=pageopen,
  addresource=videos/cloudsnew.mp4,
  flashvars={source=videos/cloudsnew.mp4}
  ]{}{VPlayer.swf}
\end{frame}

%%%

\begin{frame}{}
  \begin{center}
    {\huge Thank You!}
  \end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% appendix %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix

\begin{frame}[label=jacobian]{Jacobian (Differentiation)}
  \begin{block}{Jacobian Equation}
    \begin{align*}
      {\bm J}_{{\bm i}_c}({\bm n}) &= \\
      &L^{\rm TOA}{\sigma}^{\rm
        aerosol}({\bf A}-{\bf B}) \OpDiag{\exp[-(\vect{\tau}_c^{\rm air} +
        {\sigma}^{\rm aerosol} {\bm D}_c {\bm n})]}
      \transpose{\OpCamera_c}
    \end{align*}
    where
    \begin{align*}
      {\bf A} &= \varpi^{\rm aerosol}
      \OpDiag{ P_g^{\rm aerosol}(\vect{\Phi}^{\rm scatter}_c)} \\
      {\bf B} &= \transpose{{\bm D}_c}
      \OpDiag{[\tilde{\vect{\alpha}}^{\rm air}_c + \varpi^{\rm
          aerosol}\sigma^{\rm aerosol} P^{\rm aerosol}_g(\vect{\Phi}^{\rm
          scatter}_c) \odot{\bm n}    ]}
    \end{align*}
  \end{block}
  \hfill\hyperlink{gradient}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=mask]{Multi-Scattering Mask}
  \begin{itemize}
  \item Weight error by Single-Scattering dominance
  \item Calculated empirically
  \end{itemize}
  \centerline{\includegraphics[height=4cm]{images/sun_mask.pdf}}
  \hfill\hyperlink{objective<3>}{\beamerreturnbutton{Return}} 
\end{frame}

%%%

\begin{frame}[label=regularization]{Regularization}
  \begin{itemize}
  \item Aerosol distributions are usually fuzzy
  \item 3D Laplacian enforces {\em smoothness}: $\Laplacian{\bm n} = \| \nabla^2{\bm  n}\|^2_2$
  \item Weighted by altitude: $w(k)=\exp\left[-h(k)/H^\mathrm{smooth}\right]$
  \item Regularization by $\Psi({\bm n}) = \| {\bf W} \Laplacian{\bm n}\|^2_2$
  \end{itemize}

  \hfill\hyperlink{objective<3>}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=ref_images]{Refernce Image}
  \begin{columns}[T]
    \begin{column}{.5\textwidth}
      \centering
        \includegraphics[height=0.60\textheight]{images/result_mc.pdf}
        \captionof{figure}{Monte Carlo Model}
    \end{column}
    \begin{column}{.5\textwidth}
      \centering
        \includegraphics[height=0.60\textheight]{images/result_single.pdf}
        \captionof{figure}{Single Scattering Model}
    \end{column}
  \end{columns}

  \hfill\hyperlink{objective<2>}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=aerosols-data]{Aerosols Info}
  \begin{center}
    \includegraphics<1>[width=\columnwidth]{images/aerosol_micrographs.jpg}
    \includegraphics<2>[height=7cm]{images/radiation_budget.jpg}
  \end{center}    
  \begin{flushright}
    \only<1> {\tiny http://earthobservatory.nasa.gov/Features/Aerosols/}
    \only<2> {\tiny http://calipsooutreach.hamptonu.edu/index.html}
  \end{flushright}
  \hfill\hyperlink{motivation}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=typical-concentrations]{Typical Aerosol Concentrations}
  \begin{center}
    \setlength{\tabcolsep}{5pt}
    \footnotesize
    \begin{tabular}{ l c c }
      \hline
      Atmosphere type & part./$m^3$ & Main radii $\mu m$ \\
      \hline
      Clean Country Air & $10^8$ & 0.1-1.0 \\[0.2cm]
      Pale blue haze, industr. & $10^{11}$ & 0.03-0.2 \\[0.2cm]
      Fog & $10^6$-$5 \times 10^7$ & 3-60 \\[0.2cm]
      Clouds, higher altitudes & $5 \times 10^7$-$1.5 \times 10^9$ & 2-30 \\
      \hline
    \end{tabular}
    \begin{flushright}
      {\tiny Source. Levi, Applied Optics, Volume 2}
     \end{flushright}
  \end{center}  
  \hfill\hyperlink{settings<5>}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=particle-type]{NASA - Component Particle Properties}
  \framezoom<1><2>[border](0cm,5.5cm)(7cm,0.71cm)
  \begin{center}
    \includegraphics[height=6.5cm]{images/particle_data.jpg}
  \end{center}    
  \hfill{\tiny Source. NASA}\hyperlink{settings<5>}{\beamerreturnbutton{Return}}
\end{frame}

%%%

\begin{frame}[label=air-density]{Atmosphere Density}
  \begin{center}
    \includegraphics[height=6.5cm]{images/vert_dist.jpg}
  \end{center}    
  \begin{flushright}
    {\tiny http://apollo.lsc.vsc.edu/}  \hyperlink{settings<4>}{\beamerreturnbutton{Return}}
  \end{flushright}
\end{frame}

%%%

\begin{frame}[label=tomo-algo]{Tomography Algorithms}
  \begin{block}{Filtered Back Projection}
    \only<1>{Linear projection is Radon transform}
    \only<2>{Invert using inverse Radon transform}
    \only<3>{Apply high pass filtering}
  \end{block}

  \begin{center}
    \includegraphics<1>[height=6.5cm]{images/radon.jpg}
    \includegraphics<2>[height=6.5cm]{images/radon_inv.jpg}
    \includegraphics<3>[height=6.5cm]{images/radon_inv_filt.jpg}
  \end{center}
\end{frame}

\begin{frame}{Tomography Algorithms}
  \begin{block}{ART - Algebraic Reconstruction Technique}
    Solve a set of linear equations of the form: \\
    \begin{equation*}
      \mat{A} \vect{x} = \vect{b}
    \end{equation*}
    using an iterative algorithm: \\
    \begin{equation*}
      \vect{x}^{k+1} = \vect{x}^{k} + \lambda_k \frac{b_{i} - \langle \vect{a}_{i}, \vect{x}^{k} \rangle}{\lVert \vect{a}_{i} \rVert^2} \vect{a}_{i}
    \end{equation*}
  \end{block}

\end{frame}

% \begin{frame}{Common Atmospheric Models}
%   \begin{itemize}
%   \item<1> 1D or 2D models
%   \end{itemize}

%   \begin{center}
%     \includegraphics<1>[height=6cm]{images/atmosphere_layer.jpg}
%   \end{center}

%   \begin{flushright}
%     \only<1> {\tiny image taken from the Stratospheric Ozone Electronic Textbook}
%   \end{flushright}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%% end %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

